---
name: gitmoji-commit
description: git commit を実行する際に自動的に呼び出され、カスタム gitmoji ルールに従ってコミットメッセージを作成するスキル
---

# Gitmoji Commit Message Generator

## Instructions

ユーザーが git commit を指示した際に、ステージングされた変更内容を分析し、[gitmoji](https://gitmoji.dev/)を参考にした独自の絵文字ルールに従ってコミットメッセージを自動生成します。以下の 8 つの絵文字のみを使用してください。

1. 🚚 ファイルの移動・リネーム
2. 📝 ドキュメントの更新
3. 🔧 設定ファイルの更新
4. 📦 依存関係の更新
5. ✅ テストの更新
6. ✨ 新機能の実装
7. ♻️ リファクタリング
8. 🐛 バグ修正

## Procedure

### 1. 変更内容を確認し、候補の絵文字をリストアップ

`git diff --staged --name-status` と `git diff --staged` を実行し、以下の条件に該当する絵文字を候補としてリストアップ:

- **🚚 ファイルの移動・リネーム**
  - 条件: ファイルやディレクトリの名前変更、または別の場所への移動を行うコミット。コード内容の変更を含まない
  - 例: `git diff --staged --name-status` の出力に `R` が含まれる
- **📝 ドキュメント更新**
  - 条件: プログラムの動作には一切影響を与えず、文書のみを更新するコミット
  - 例: `.md`, `.txt`, `.rst`, `docs/` 配下のファイル、コード内コメント、README、使用方法の説明
- **🔧 設定ファイル更新**
  - 条件: プロジェクトの動作環境や開発環境に関わる設定を変更するコミット。ソースコード本体は変更しない
  - 例: `.json`, `.toml`, `.yaml`, `.yml`, `.config.js`, `.rc`, `.env.example`, `.github/workflows/` 配下、ビルドスクリプト、CI/CD 設定
- **📦 依存関係の更新**
  - 条件: プロジェクトが依存する外部ライブラリに関する変更を行うコミット。設定ファイルのみの変更は含まない
  - 例: `uv.lock`, `package-lock.json`, `requirements.txt`, `Cargo.lock`、ライブラリの追加・バージョンアップ・削除
- **✅ テストの更新**
  - 条件: テストコードの追加や修正を行うコミット。プロダクションコード本体は変更しない
  - 例: `test_*.py`, `*.test.ts`, `*.spec.js`, `*.test.tsx`, `__tests__/` 配下、`tests/` 配下、`spec/` 配下、テストケース追加、テストデータ修正
- **✨ 新機能の実装**
  - 条件: ユーザーに提供する新しい機能を追加するコミット。既存機能の改善ではなく、完全に新しい機能の実装
  - 例: 新規の `def`, `class`, `function`, `async def`, `interface`, `type` 定義、新しいエンドポイント、新しい API、新しいモジュール
- **♻️ リファクタリング**
  - 条件: 外部から見た動作は変更せず、内部実装のみを改善するコミット
  - 例: 長い関数の分割、重複コードの共通化、変数名やメソッド名の改善、型定義の明確化、アルゴリズムの最適化、保守性・可読性・パフォーマンスの向上
- **🐛 バグ修正**
  - 条件: プログラムの誤動作や期待通りに動作しない問題を修正するコミット。既存の機能を正しく動作させるための変更
  - 例: null/undefined チェック漏れの修正、オフバイワンエラーの修正、競合状態の解消、メモリリークの修正、例外処理の追加

### 2. 候補の数による判定

1. **候補が 1 つのみ**: ステップ 3 へ進む
2. **候補が複数**: コミットを中止し、以下のメッセージを表示

```
このコミットには複数の異なる種類の変更が含まれています:
- [検出された変更種類1の説明]
- [検出された変更種類2の説明]

コミットは種類ごとに分割することを推奨します。
ステージングを解除し、変更種類ごとに git add してコミットしてください。
```

### 3. コミットメッセージを作成して実行

以下のフォーマットでコミットメッセージを作成し、コミットを実行:

```
{emoji} {簡潔な変更内容}

{詳細な説明: 必要に応じて複数行で変更の背景や理由を記述}

🤖 Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>
```

## Examples

以下は、各絵文字を使用した良いコミットメッセージの例です(1 行目のみを示しています):

- 🚚 utils/ → src/utils に移動
- 📝 API エンドポイントの使用方法を README に追加
- 🔧 GitHub Actions のワークフローに自動デプロイを追加
- 📦 FastAPI 更新 (0.109.0 → 0.110.0)
- ✅ ユーザー認証機能のユニットテストを追加
- ✨ 重複 item_id 検出機能を追加
- ♻️ 長い handle_request 関数を複数の小さな関数に分割
- 🐛 Lambda 環境でのインポートパスを修正
- 📦 開発依存関係に pytest-mock を追加
- ✨ GraphQL エンドポイント /api/graphql を実装
